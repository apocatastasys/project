# Проектная работа

Создание процесса непрерывной поставки для приложения с применением Практик CI/CD и быстрой обратной связью.

Требования к проекту:

Автоматизированные процессы создания и управления платформой
- Ресурсы Ya.cloud
- Инфраструктура для CI/CD
- Инфраструктура для сбора обратной связи
Использование практики IaC (Infrastructure as Code) для управления
конфигурацией и инфраструктурой
- Настроен процесс CI/CD
Настроен процесс сбора обратной связи
- Мониторинг (сбор метрик, алертинг, визуализация)
- Логирование (опционально)
- Трейсинг (опционально)
- ChatOps (опционально)

Документация
- README по работе с репозиторием
- Описание приложения и его архитектуры
- How to start?
- ScreenCast
- CHANGELOG с описанием выполненной работы


Репозиторий проекта расположен на сайте github.com по адресу: https://github.com/apocatastasys/project .
Для работы с проектом на компьютере разработчика должно быть установлено следующее ПО:
 - YC CLI - интерфейс командной строки YandexCloud. Устанавливается согласно инструкции: https://cloud.yandex.ru/docs/cli/operations/install-cli.
 - git версии не ниже 1.8.3.1. Установка производится по инструкции: https://git-scm.com/book/ru/v2/%D0%92%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B8%D0%B5-%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0-Git
 - docker версии не ниже 20.10.7 и docker-compose версии не ниже 1.25.0. Установка производится согласно следующей инструкции: https://docs.docker.com/engine/install/ .
 - docker-machine версии не ниже  0.16.0. Установка производится по инструкции: https://linux-notes.org/ustanovka-docker-machine-v-unix-linux/ 
 - terraform не ниже v0.12.0, инструкция: https://learn.hashicorp.com/tutorials/terraform/install-cli
 
 На подготовленную машину необходимо склонировать проект клонировать проект https://github.com/apocatastasys/project.git 
 Разворачивание виртуальной машины осуществляется при помощи terraform, для чего необходимо перейти в папку terraform  и выполнить terraform apply -auto-approve, предварительно подтставив свои значения YC в файл переменных variables.tf.
 CI/CD осуществляется посредством Gitlab, развернутом на вм YandexCloud (необходимо выполнить docker-compose up -d из папки omnibus, предварительно заменив в файле docker-compose.yml адрес внешнего IP на свой адрес  вм YandexCloud) дополнительно на данном сервере установливается gitlab-runner по инструкции https://docs.gitlab.com/runner/install/ и регестрируются runner-ы docker и shell согласно инструкции - https://docs.gitlab.com/runner/commands/#gitlab-runner-register .
 - Для хранения созданных образов используется публичный репозиторий hub.docker.com, на котором требуется зарегистрироваться. После чего в настройках Gitlab (settings-CI/CD) необходимо создать переменные: "DockerHubLogin" и "DockerhubToken" для хранения логина и пароля от репозитория.
 - Для управления докер контейнерами используется ранеесозданный инстанс docker-machine с именем project-host, для чего необходимо выполнить команду  eval $(docker-machine env project-host).

Для развертывания проекта необходимо, на развернутом Gitlab (находится на внешнем IP вм YandexCloud) клонировать проект https://github.com/apocatastasys/project.git , после чего запустить pipline.
После завершения пайплайна сайт будет доступен по адресу: http://HOST_IP:8000/, где HOST_IP - адрес хоста на котором запущен веб-интерфейс. 
на этом же адресе доступен по порту:
 - 9090 - интерфейс службы Prometheus, собирающий метрики
 - 3000 - интерфейс службы Grafana построение графиков и визуализация.
